# MCPX Roadmap

## 项目状态

根据 [验证文档](./requirements/)，核心功能（8 个条款）已全部完成：

- ✅ FastMCP 框架架构
- ✅ 工具注册表与缓存
- ✅ 长连接执行器
- ✅ MCP 代理服务器（inspect + exec + resources）
- ✅ 双传输方式（stdio + HTTP/SSE）
- ✅ 配置驱动
- ✅ 错误处理与降级
- ✅ E2E 测试覆盖（75%）

---

## 已完成功能

| # | 功能 | PR | 日期 |
|---|------|----|----|
| 1 | 核心功能（Registry、Executor、inspect/exec） | #1 | 2026-01-24 |
| 2 | Docker 支持 | #2 | 2026-01-24 |
| 3 | TOON 压缩 + 健康检查 + 多模态内容 | #3 | 2026-01-25 |
| 4 | Schema 压缩（TypeScript 风格） | #4 | 2026-01-25 |
| 5 | MCP Resource 动态加载 | #5 | 2026-01-25 |

---

## 待办事项

### P0 - 紧急 / 高价值

#### 1. 🔄 连接稳定性（ProxyProvider 重构）
**状态**：待开发

**描述**：采用 FastMCP ProxyProvider 重构连接管理，利用其 Session Isolation 特性获得连接恢复能力。

**背景**：
FastMCP ProxyProvider 的 Session Isolation 设计意味着每个请求可获得独立会话，无需手动实现重连逻辑：
- 当前 MCPX：长连接 + 手动重连 = 复杂度高
- ProxyProvider：会话隔离 = 隐式连接恢复

**实现要点**：
- 使用 `ProxyClient` 替代手动 `Client` 管理
- 利用 session isolation 特性处理连接断开
- 保持 `inspect`/`exec` 接口不变

**影响范围**：`src/mcpx/registry.py`

---

### P1 - 高优先级

#### 2. 📊 可观测性增强
**状态**：待开发

**描述**：添加日志、指标和追踪支持。

**实现要点**：
- 结构化日志（JSON 格式）
- 关键指标暴露：连接状态、工具调用次数和延迟、错误率
- OpenTelemetry 集成（可选）

---

#### 3. ⚡ 性能优化
**状态**：待开发

**描述**：提升高并发场景下的性能表现。

**实现要点**：
- 连接池优化（复用策略）
- 并发限制（每服务器最大并发数）
- 请求超时配置
- 工具结果缓存（可选，短 TTL）

---

#### 4. 🧪 测试覆盖率提升
**状态**：持续改进

**描述**：将测试覆盖率从 74% 提升到 85%+。

**重点区域**：边界条件和错误路径、并发场景、配置解析

---

### P3 - 低优先级

#### 5. 🔥 配置热加载
**状态**：待开发

**描述**：支持不重启服务更新配置。

**实现要点**：
- 监听配置文件变更
- 增量更新连接（新增/移除服务器）
- 配置变更事件通知

---

#### 6. 🖥️ Web 管理界面
**状态**：待开发

**描述**：提供可视化管理界面。

**功能**：服务器连接状态、工具列表和调用统计、配置管理、日志查看

---

#### 7. 🔌 连接池动态扩缩容
**状态**：待开发

**描述**：根据负载自动调整连接池大小。

---

## 优先级说明

| 优先级 | 含义 | 决策依据 |
|--------|------|----------|
| P0 | 紧急 / 高价值 | 影响核心稳定性或已在开发中 |
| P1 | 高优先级 | 对用户体验有重大提升 |
| P2 | 中优先级 | 改进性能和可维护性 |
| P3 | 低优先级 | 锦上添花，可延后 |

---

## 版本规划

### v0.1.0 - 基础版本 ✅
- ✅ 核心功能（Registry、Executor、inspect/exec）
- ✅ stdio + HTTP/SSE 双传输
- ✅ 配置驱动
- ✅ E2E 测试 74% 覆盖率

### v0.2.0 - 增强版本 ✅
- ✅ TOON 压缩
- ✅ 健康检查
- ✅ 多模态内容透传
- ✅ Docker 支持
- ✅ Schema 压缩（TypeScript 风格）

### v0.3.0 - 资源支持版本 ✅
- ✅ MCP Resource 动态加载
- ✅ resources 工具（列表/读取资源）

### v0.4.0 - 稳定性版本（规划）
- [ ] 连接稳定性（ProxyProvider 重构）

### v0.5.0 - 优化版本（规划）
- [ ] 可观测性增强
- [ ] 性能优化
- [ ] 测试覆盖率提升到 85%+

### v0.6.0 - 功能版本（规划）
- [ ] 配置热加载
- [ ] Web 管理界面

---

*最后更新：2026-01-25（MCP Resource 支持已完成）*
